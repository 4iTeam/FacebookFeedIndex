<?php
namespace App\Services\Profile;

class RandomProfile {
	/**
	 * @var Profile[]
	 */
	protected $profiles = [];
	protected $last_names = [
		'Nguyễn' => 38.4,
		'Trần'   => 12.1,
		'Lê'     => 9.5,
		'Phạm'   => 7,
		'Hoàng'  => 5.1,
		'Huỳnh'  => 5.1,
		'Phan'   => 4.5,
		'Vũ'     => 3.9,
		'Võ'     => 3.9,
		'Đặng'   => 2.1,
		'Bùi'    => 2,
		'Đỗ'     => 1.4,
		'Hồ'     => 1.3,
		'Ngô'    => 1.3,
		'Dương'  => 1,
		'Lý'     => 0.5,
	];
	protected $list = [

		'm' => [//male
			'first_names'  => [
				'An',
				'Ân',
				'Âu',
				'Anh',
				'Ánh',
				'Ba',
				'Ban',
				'Bản',
				'Bảo',
				'Bắc',
				'Bách',
				'Bạch',
				'Bằng',
				'Bình',
				'Bính',
				'Bửu',
				'Biên',
				'Biền',
				'Biển',
				'Bôn',
				'Bồn',
				'Cường',
				'Cảnh',
				'Châu',
				'Chi',
				'Chân',
				'Chí',
				'Chinh',
				'Chính',
				'Chiến',
				'Chiểu',
				'Chung',
				'Chương',
				'Công',
				'Cung',
				'Cương',
				'Ca',
				'Cầm',
				'Cẩm',
				'Cần',
				'Cao',
				'Cầu',
				'Các',
				'Cát',
				'Cơ',
				'Cúc',
				'Chuyện',
				'Dần',
				'Đán',
				'Đang',
				'Điệp',
				'Độ',
				'Đoan',
				'Đường',
				'Dân',
				'Di',
				'Dũng',
				'Dụng',
				'Du',
				'Dư',
				'Dự',
				'Danh',
				'Dậu',
				'Diễm',
				'Diệp',
				'Diệu',
				'Dương',
				'Dung',
				'Duy',
				'Duyên',
				'Duyệt',
				'Dao',
				'Đăng',
				'Đài',
				'Đắc',
				'Đại',
				'Đan',
				'Đàn',
				'Đào',
				'Đạo',
				'Đạt',
				'Điền',
				'Đảng',
				'Đình',
				'Định',
				'Đôn',
				'Đoàn',
				'Đông',
				'Đồng',
				'Đức',
				'Doãn',
				'Doanh',
				'Giản',
				'Giang',
				'Giáo',
				'Giao',
				'Giảng',
				'Gia',
				'Giá',
				'Giáp',
				'Giới',
				'Hảo',
				'Hiệu',
				'Hà',
				'Hạ',
				'Hải',
				'Hậu',
				'Hân',
				'Hào',
				'Hanh',
				'Hành',
				'Hạnh',
				'Hiền',
				'Hiến',
				'Hiển',
				'Hiếu',
				'Hiệp',
				'Hoa',
				'Hòa',
				'Hóa',
				'Hòe',
				'Hoàn',
				'Hoan',
				'Hoàng',
				'Học',
				'Hợi',
				'Hồ',
				'Hồng',
				'Hổ',
				'Hoạt',
				'Hùng',
				'Huân',
				'Huấn',
				'Hữu',
				'Hựu',
				'Huy',
				'Hưng',
				'Hy',
				'Hỷ',
				'Hồi',
				'Hợp',
				'Huỳnh',
				'Ha',
				'Khương',
				'Kha',
				'Khiêm',
				'Khuyến',
				'Khải',
				'Khắc',
				'Khanh',
				'Khánh',
				'Khang',
				'Kháng',
				'Khê',
				'Khâm',
				'Khoa',
				'Khôi',
				'Khoan',
				'Khởi',
				'Kế',
				'Khuê',
				'Kiệt',
				'Kiên',
				'Kim',
				'Kiệm',
				'Kính',
				'Kỳ',
				'Kỷ',
				'Kiện',
				'Liêm',
				'Lam',
				'Lạc',
				'Lâm',
				'Lân',
				'Linh',
				'Lãnh',
				'Lĩnh',
				'Lê',
				'Lễ',
				'Lộ',
				'Long',
				'Lộc',
				'Lợi',
				'Lư',
				'Lữ',
				'Lương',
				'Lũy',
				'Lưu',
				'Luân',
				'Luận',
				'Luyến',
				'Luyện',
				'Lý',
				'Ly',
				'Lai',
				'Lực',
				'Luật',
				'Mạnh',
				'Mẫn',
				'Mân',
				'Mão',
				'Mậu',
				'Minh',
				'Miên',
				'Miện',
				'Mùi',
				'Mỹ',
				'Mộng',
				'Nga',
				'Ngộ',
				'Ninh',
				'Nghiêm',
				'Ngạn',
				'Nhi',
				'Nhiên',
				'Như',
				'Nghi',
				'Nghị',
				'Ngọ',
				'Ngữ',
				'Nam',
				'Nữ',
				'Nương',
				'Ngân',
				'Nghệ',
				'Nghĩa',
				'Nguyên',
				'Nguyện',
				'Nghiên',
				'Nghiệp',
				'Nhã',
				'Nhạ',
				'Nham',
				'Nhan',
				'Nhạn',
				'Nhân',
				'Nhẫn',
				'Ngọc',
				'Ngà',
				'Ngôn',
				'Nhật',
				'Oánh',
				'Oanh',
				'Ôn',
				'Oai',
				'Phương',
				'Phước',
				'Phiêu',
				'Phú',
				'Phụ',
				'Phụng',
				'Phúc',
				'Phục',
				'Phát',
				'Phan',
				'Pháp',
				'Phi',
				'Phiên',
				'Phùng',
				'Phượng',
				'Phong',
				'Phòng',
				'Quy',
				'Quế',
				'Quỳ',
				'Quý',
				'Quyên',
				'Quyền',
				'Quyết',
				'Quyến',
				'Quốc',
				'Quang',
				'Quảng',
				'Quỳnh',
				'Quản',
				'Quân',
				'Quán',
				'Quan',
				'Sa',
				'San',
				'Sâm',
				'Sinh',
				'Siêu',
				'Sơn',
				'Sự',
				'Sử',
				'Sửu',
				'Sương',
				'Sỹ',
				'Sang',
				'Sáng',
				'Thiều',
				'Tiến',
				'Túy',
				'Thái',
				'Thành',
				'Thắng',
				'Thạch',
				'Tài',
				'Thân',
				'Thiên',
				'Thiện',
				'Thiệu',
				'Thích',
				'Thìn',
				'Thu',
				'Thư',
				'Thụ',
				'Thuận',
				'Thảo',
				'Tỵ',
				'Tý',
				'Tín',
				'Tích',
				'Tâm',
				'Tân',
				'Tần',
				'Tấn',
				'Tảo',
				'Tiên',
				'Tuất',
				'Tuyên',
				'Tuyền',
				'Tuyến',
				'Tuân',
				'Tuấn',
				'Toàn',
				'Toản',
				'Trường',
				'Túc',
				'Tùng',
				'Thi',
				'Thùy',
				'Thụy',
				'Thông',
				'Thống',
				'Trinh',
				'Trịnh',
				'Trình',
				'Trung',
				'Tú',
				'Tứ',
				'Thăng',
				'Trúc',
				'Trực',
				'Thanh',
				'Thạnh',
				'Thịnh',
				'Tráng',
				'Thường',
				'Trân',
				'Trứ',
				'Tri',
				'Trí',
				'Trị',
				'Triết',
				'Thọ',
				'Tường',
				'Tưởng',
				'Tuệ',
				'Trác',
				'Trụ',
				'Trà',
				'Toại',
				'Trọng',
				'Thuần',
				'Triệu',
				'Thục',
				'Triều',
				'Trưởng',
				'Thắm',
				'Thịnh',
				'Uyển',
				'Uy',
				'Viên',
				'Viễn',
				'Văn',
				'Vân',
				'Việt',
				'Vinh',
				'Vĩ',
				'Vị',
				'Vĩnh',
				'Vọng',
				'Vũ',
				'Vụ',
				'Vương',
				'Vượng',
				'Võ',
				'Xuân',
				'Xuyên',
				'Xuyến',
				'Xứng',
				'Yên',
				'Yến',

			],
			'middle_names' => [ 'Văn', 'Thanh', 'Thế', 'Đức', 'Quốc', 'Mỹ', 'Hoài', 'Xuân' ],
		],
		'f' => [//female
			'first_names'  => [
				'An',
				'Ân',
				'Âu',
				'Anh',
				'Ánh',
				'Bình',
				'Chinh',
				'Châu',
				'Chiều',
				'Cài',
				'Chung',
				'Diệp',
				'Điệp',
				'Dung',
				'Duyên',
				'Doanh',
				'Dịu',
				'Én',
				'Giang',
				'Huê',
				'Huế',
				'Huệ',
				'Hảo',
				'Huyền',
				'Hà',
				'Hạnh',
				'Hậu',
				'Hoa',
				'Hòa',
				'Hoài',
				'Hằng',
				'Hồng',
				'Hiền',
				'Hương',
				'Hường',
				'Khuê',
				'Khuyên',
				'Lan',
				'Linh',
				'Lê',
				'Lựu',
				'Loan',
				'Lệ',
				'Liên',
				'Liễu',
				'Lương',
				'Lý',
				'My',
				'Mi',
				'Mai',
				'Miên',
				'Minh',
				'Nga',
				'Nhi',
				'Nữ',
				'Nụ',
				'Nhung',
				'Ngọc',
				'Nhài',
				'Nguyệt',
				'Ngân',
				'Nhật',
				'Nhạn',
				'Nghi',
				'Ngoan',
				'Oanh',
				'Phương',
				'Phong',
				'Phi',
				'Phượng',
				'Sương',
				'Thu',
				'Thư',
				'Thúy',
				'Thùy',
				'Thủy',
				'Trang',
				'Tuyết',
				'Trâm',
				'Thoa',
				'Thương',
				'Trinh',
				'Trúc',
				'Thanh',
				'Uyên',
				'Vy',
				'Vi',
				'Vui',
				'Xuân',
				'Xuyến',
				'Yên',
				'Yến'

			],
			'middle_names' => [
				'Thị',
				'Ngọc',
				'Lan',
				'Hồng',
				'Phương',
				'Kiều',
				'Thu',
				'Xuân',
				'Thùy'
			],
		]
	];
	protected $data;

	function __construct() {
		$lastNames      = array_map( function ( $w ) {
			return $w * 10;
		}, $this->last_names );
		$this->lastName = new BiasRandom( $lastNames );
	}

	function reset() {
		$this->profiles = [];
		$this->data     = $this->list;

		return $this;
	}

	function getFirstName( $gender ) {
		$total = count( $this->list[ $gender ]['first_names'] );
		$index = mt_rand( 0, $total - 1 );

		return $this->list[ $gender ]['first_names'][ $index ];
	}

	function getMiddleName( $gender ) {
		$total = count( $this->list[ $gender ]['middle_names'] );
		$index = mt_rand( 0, $total - 1 );

		return $this->list[ $gender ]['middle_names'][ $index ];

	}

	function getGender() {
		$a = [ 'f', 'm' ];

		return $a[ mt_rand( 0, 1 ) ];
	}

	/**
	 * @param int $count
	 * @param bool $reset
	 *
	 * @return Profile[]
	 */
	function getProfiles( $count = 1, $reset = false ) {
		if ( empty( $this->profiles ) || $reset ) {
			$this->generateProfiles( $count );
		}

		return $this->profiles;
	}

	function generateProfiles( $count = 1 ) {
		$this->reset();
		for ( $i = 0; $i < $count; $i ++ ) {
			$g   = $this->getGender();
			$p   = new Profile( [
				'f' => $this->getFirstName( $g ),
				'm' => $this->getMiddleName( $g ),
				'l' => $this->lastName->random( 1 )[0],
				'g' => $g
			] );
			$key = $p->getKey();
			if ( $p->valid() && ! isset( $this->profiles[ $key ] ) ) {
				$this->profiles[ $key ] = $p;
			} else {
				$i --;
			}
		}

		return $this;
	}

}
